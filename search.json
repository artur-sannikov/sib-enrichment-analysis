[
  {
    "objectID": "sib_enrichment_analysis_exercises.html",
    "href": "sib_enrichment_analysis_exercises.html",
    "title": "SIB - Enrichment Analysis",
    "section": "",
    "text": "library(clusterProfiler)\nlibrary(enrichplot)\nlibrary(pathview)\nlibrary(org.Hs.eg.db)\nlibrary(ggplot2)\nlibrary(ggrepel)\nlibrary(msigdbr)\n\nlibrary(tidyverse) # for bonus code/dplyr/pipe\n\n# set seed\nset.seed(1234)\n\n\n# Import DE table:\nNK_vs_Th &lt;- read.csv(\"data/NK_vs_Th_diff_gene_exercise_1.csv\",\n  header = T\n)\n# Look at the structure of the data.frame:\nhead(NK_vs_Th)\n\n  ensembl_gene_id   symbol      logFC         t      P.Value        p.adj\n1 ENSG00000000003   TSPAN6 -5.6436044 -4.672128 0.0000426000 7.358019e-04\n2 ENSG00000000419     DPM1 -0.1818981 -1.101831 0.2780198240 5.176076e-01\n3 ENSG00000000457    SCYL3  0.4969874  1.491035 0.1448690710 3.449889e-01\n4 ENSG00000000460 C1orf112  1.1217991  1.445899 0.1570598770 3.630935e-01\n5 ENSG00000000938      FGR 10.6706873  7.212342 0.0000000198 1.718657e-06\n6 ENSG00000000971      CFH -3.4129277 -2.788887 0.0084803000 4.610083e-02\n\n# Search for a gene symbol in the data.frame, eg NCAM1 (CD56)\nNK_vs_Th[which(NK_vs_Th$symbol == \"NCAM1\"), ]\n\n     ensembl_gene_id symbol    logFC        t  P.Value        p.adj\n7624 ENSG00000149294  NCAM1 12.19755 6.992219 3.81e-08 2.845553e-06\n\n\nSearch for 2 genes in the data.frame, CPS1 and GZMB, and verify the effect of adjustment on their p-values\n\ngenes &lt;- c(\"CPS1\", \"GZMB\")\nNK_vs_Th |&gt;\n  filter(symbol %in% genes) |&gt;\n  select(symbol, P.Value, p.adj)\n\n  symbol     P.Value        p.adj\n1   CPS1 0.044963086 1.565113e-01\n2   GZMB 0.000000629 2.402609e-05\n\n\nCPS1 is not significant, while GZMB is significant.\n\n# Import the adaptive immune response gene set (gmt file)\nadaptive &lt;- clusterProfiler::read.gmt(\"data/GOBP_ADAPTIVE_IMMUNE_RESPONSE.v7.5.1.gmt\")\nnrow(adaptive) # 719\n\n[1] 719\n\n\n\nlength(which(NK_vs_Th$symbol %in% adaptive$gene)) # 513\n\n[1] 513\n\n\n\nupregulated_th &lt;- subset(\n  NK_vs_Th,\n  NK_vs_Th$p.adj &lt;= 0.05 & NK_vs_Th$logFC &lt; 0\n)\n\nnot_significant_genes &lt;- subset(\n  NK_vs_Th,\n  NK_vs_Th$p.adj &gt; 0.05\n)\n\nsummary_upregulated &lt;- summary(upregulated_th$symbol %in% adaptive$gene)\nsummary_not_significant &lt;- summary(not_significant_genes$symbol %in% adaptive$gene)\n\n\ncontingency_table &lt;- matrix(, nrow = 2, ncol = 2)\ncontingency_table[[1]] &lt;- summary_upregulated[[3]] # up, in gene set\ncontingency_table[[2]] &lt;- summary_upregulated[[2]] # up, not in gene set\ncontingency_table[[3]] &lt;- summary_not_significant[[3]] # down, in gene set\ncontingency_table[[4]] &lt;- summary_not_significant[[2]] # down, not in gene set\n\n# Convert to numeric\ncontingency_table &lt;- apply(contingency_table, 2, as.numeric)\n\n# Add rows and columns\ncolnames(contingency_table) &lt;- c(\"up\", \"down\")\nrownames(contingency_table) &lt;- c(\"in_set\", \"not_in_set\")\n\n\nfisher.test(contingency_table)\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  contingency_table\np-value &lt; 2.2e-16\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n 3.697701 5.654348\nsample estimates:\nodds ratio \n  4.580549 \n\n\nThe odds ratio tells us how different the two proportions are.\nIf the confidence interval does not include 1, then p-value is small. We can reject null hypothesis thatthe odds ratio is equal to 1.\nThere are more genes that are upregulated in the gene set than the genes that are not upregulated in the gene set.\n\n# Test 3 gene sets among the genes up-regulated in NK cells,\n# with enricher()\n# First, obtain the genes up-regulated in NK:\n\nnk_up_genes &lt;- subset(NK_vs_Th, NK_vs_Th$logFC &gt; 0 & NK_vs_Th$p.adj &lt;= 0.05)$symbol\n\n# Import 2 other gene sets, 1 un-related to immune cells:\nhair &lt;- read.gmt(\"data/GOBP_HAIR_CELL_DIFFERENTIATION.v7.5.1.gmt\")\ndim(hair)\n\n[1] 47  2\n\ncell_active &lt;- read.gmt(\"data/GOBP_CELL_ACTIVATION.v7.5.1.gmt\")\ndim(cell_active)\n\n[1] 1095    2\n\n# Combine the 3 gene sets into a single data.frame for the TERM2GENE argument:\ngenesets3 &lt;- rbind(adaptive, hair, cell_active)\n\nhyper_3genesets &lt;- enricher(\n  gene = nk_up_genes,\n  universe = NK_vs_Th$symbol,\n  TERM2GENE = genesets3,\n  maxGSSize = 1000\n)\nhyper_3genesets@result\n\n                                                           ID\nGOBP_CELL_ACTIVATION                     GOBP_CELL_ACTIVATION\nGOBP_HAIR_CELL_DIFFERENTIATION GOBP_HAIR_CELL_DIFFERENTIATION\nGOBP_ADAPTIVE_IMMUNE_RESPONSE   GOBP_ADAPTIVE_IMMUNE_RESPONSE\n                                                  Description GeneRatio\nGOBP_CELL_ACTIVATION                     GOBP_CELL_ACTIVATION   173/200\nGOBP_HAIR_CELL_DIFFERENTIATION GOBP_HAIR_CELL_DIFFERENTIATION     5/200\nGOBP_ADAPTIVE_IMMUNE_RESPONSE   GOBP_ADAPTIVE_IMMUNE_RESPONSE    82/200\n                                BgRatio      pvalue    p.adjust      qvalue\nGOBP_CELL_ACTIVATION           896/1138 0.001505054 0.004515163 0.003168535\nGOBP_HAIR_CELL_DIFFERENTIATION  34/1138 0.741306145 0.912609682 0.640427847\nGOBP_ADAPTIVE_IMMUNE_RESPONSE  513/1138 0.912609682 0.912609682 0.640427847\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             geneID\nGOBP_CELL_ACTIVATION           FGR/CD38/SKAP2/ITGAL/TYROBP/RUNX3/NR1H3/SLAMF7/IFNGR1/STAP1/HDAC9/TSPAN32/RHOA/RAB27A/FCGR2B/TBX21/CST7/HOXA9/ITCH/MEF2C/PTPRC/LAT2/ICAM1/SNAP23/ABL1/HMOX1/IL2RB/SOS2/SLA2/NFATC2/MYL9/NBN/LILRB1/NKG7/CD33/PIK3CG/TGFBR1/MAP3K8/P2RX1/PRKAR1A/CTSC/ZBTB16/CRTAM/TCIRG1/LTBR/MAPK14/PDGFRB/BCL6/CD86/CBLB/LOXL3/IGFBP2/IL18R1/ID2/PLEK/PLA2G4A/RAB29/CD160/RPS6KA1/FOXO3/TNFSF11/PTK2B/SASH3/CD244/BTN2A2/SOX4/IRF1/TNFSF14/RAC2/CRACR2A/BST2/THEMIS2/AP3B1/PRAM1/SWAP70/VAV3/PTPN22/KLRC1/HAVCR2/TEC/DYSF/SERPINE2/LCP1/LRRC8A/TLN1/THBS1/ADAM10/MMRN1/PPP3CA/SLC15A4/IRF8/ERBB2/AKT1/XCL1/ILDR2/SOX13/DGKQ/MSN/GSN/CD226/IL18/DLG5/ADAM8/HHEX/CD8A/SH3RF1/KIT/SLAMF8/F11R/FCER1G/ITGB2/FCRL3/TNFSF13/VCAM1/EOMES/PRKCD/CSF2/SYK/NFIL3/ILK/NFKBID/TMIGD2/CD300A/NLRC3/CCDC88B/PTGDR/CX3CR1/INPP5D/PRELID1/P2RY1/ITGAM/LGALS9B/LGALS9C/AZU1/CD7/PTPN2/GAPT/YES1/ZBTB7A/PRF1/CXCR2/F2R/FES/PLCB1/ADGRG3/MRGPRX2/TBK1/JAG2/CD300LF/FANCA/PLSCR1/CNR2/NCR1/HSH2D/SPN/PLCG2/CARD11/SH2D1B/FCGR3A/NCR3/KLRC2/TRDC/IGHA2/IGHA1/CLIC1/KLRK1/LILRA2/HLA-DMB/DDOST/LYN/KLRC4-KLRK1/DGKK/CCL3\nGOBP_HAIR_CELL_DIFFERENTIATION                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     TRIOBP/JAG1/SLC9A3R1/NOTCH1/JAG2\nGOBP_ADAPTIVE_IMMUNE_RESPONSE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         SLAMF7/RAB27A/FCGR2B/PVR/TBX21/STX7/MEF2C/PTPRC/LAT2/ICAM1/SLA2/JAG1/NBN/LILRB1/LILRA1/PIK3CG/CTSC/CRTAM/TCIRG1/TFEB/BCL6/CD86/LOXL3/IL18R1/PLA2G4A/CD160/PTK2B/ADCY7/SASH3/CD244/IRF1/C3/CRACR2A/RFTN1/SWAP70/KLRD1/KLRC1/HAVCR2/TEC/DBNL/SLC15A4/SIGLEC10/XCL1/NOTCH1/CD226/IL18/CD8A/FCER1G/TNFSF13/EOMES/PRKCD/ERAP1/SYK/NFKBID/LAIR1/CX3CR1/INPP5D/CD7/GAPT/C8G/PRF1/SPN/CLEC4C/SH2D1B/FCGR3A/KLRC2/IGLV2-18/IGLV2-11/TRGV9/TRBJ2-1/TRBJ2-2/TRBJ2-3/TRBJ2-4/TRBJ2-7/TRDC/IGHA2/IGHA1/SIPA1/KLRK1/HLA-DMB/LYN/KLRC4-KLRK1\n                               Count\nGOBP_CELL_ACTIVATION             173\nGOBP_HAIR_CELL_DIFFERENTIATION     5\nGOBP_ADAPTIVE_IMMUNE_RESPONSE     82\n\n\n\nsig_genes &lt;- subset(NK_vs_Th, NK_vs_Th$symbol %in% adaptive$gene &\n  NK_vs_Th$p.adj &lt;= 0.05)\nsig_genes_label &lt;- subset(sig_genes, sig_genes$p.adj &lt;= 0.00001)\n\nggplot(NK_vs_Th, aes(\n  x = logFC,\n  y = -log10(p.adj)\n)) +\n  geom_point(color = \"grey87\") +\n  ggtitle(\"Genes belonging to the adaptive immune response gene set\") +\n  theme_bw() +\n  geom_text_repel(\n    data = sig_genes_label,\n    aes(\n      x = logFC,\n      y = -log10(p.adj), label = symbol\n    ),\n    max.overlaps = 20\n  ) +\n  geom_point(data = sig_genes, col = \"dodgerblue2\") +\n  theme(legend.position = \"none\") +\n  scale_x_continuous(name = expression(\"log\"[2] * \"(fold change), NK vs Th cells\")) +\n  scale_y_continuous(name = expression(\"-\" * \"log\"[10] * \"(adj. p-value)\")) +\n  geom_hline(yintercept = -log10(0.05), linetype = \"dashed\") +\n  geom_vline(xintercept = 0, linetype = \"dashed\")\n\nWarning: ggrepel: 46 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps"
  },
  {
    "objectID": "sib_enrichment_analysis_exercises.html#exercise-1",
    "href": "sib_enrichment_analysis_exercises.html#exercise-1",
    "title": "SIB - Enrichment Analysis",
    "section": "",
    "text": "library(clusterProfiler)\nlibrary(enrichplot)\nlibrary(pathview)\nlibrary(org.Hs.eg.db)\nlibrary(ggplot2)\nlibrary(ggrepel)\nlibrary(msigdbr)\n\nlibrary(tidyverse) # for bonus code/dplyr/pipe\n\n# set seed\nset.seed(1234)\n\n\n# Import DE table:\nNK_vs_Th &lt;- read.csv(\"data/NK_vs_Th_diff_gene_exercise_1.csv\",\n  header = T\n)\n# Look at the structure of the data.frame:\nhead(NK_vs_Th)\n\n  ensembl_gene_id   symbol      logFC         t      P.Value        p.adj\n1 ENSG00000000003   TSPAN6 -5.6436044 -4.672128 0.0000426000 7.358019e-04\n2 ENSG00000000419     DPM1 -0.1818981 -1.101831 0.2780198240 5.176076e-01\n3 ENSG00000000457    SCYL3  0.4969874  1.491035 0.1448690710 3.449889e-01\n4 ENSG00000000460 C1orf112  1.1217991  1.445899 0.1570598770 3.630935e-01\n5 ENSG00000000938      FGR 10.6706873  7.212342 0.0000000198 1.718657e-06\n6 ENSG00000000971      CFH -3.4129277 -2.788887 0.0084803000 4.610083e-02\n\n# Search for a gene symbol in the data.frame, eg NCAM1 (CD56)\nNK_vs_Th[which(NK_vs_Th$symbol == \"NCAM1\"), ]\n\n     ensembl_gene_id symbol    logFC        t  P.Value        p.adj\n7624 ENSG00000149294  NCAM1 12.19755 6.992219 3.81e-08 2.845553e-06\n\n\nSearch for 2 genes in the data.frame, CPS1 and GZMB, and verify the effect of adjustment on their p-values\n\ngenes &lt;- c(\"CPS1\", \"GZMB\")\nNK_vs_Th |&gt;\n  filter(symbol %in% genes) |&gt;\n  select(symbol, P.Value, p.adj)\n\n  symbol     P.Value        p.adj\n1   CPS1 0.044963086 1.565113e-01\n2   GZMB 0.000000629 2.402609e-05\n\n\nCPS1 is not significant, while GZMB is significant.\n\n# Import the adaptive immune response gene set (gmt file)\nadaptive &lt;- clusterProfiler::read.gmt(\"data/GOBP_ADAPTIVE_IMMUNE_RESPONSE.v7.5.1.gmt\")\nnrow(adaptive) # 719\n\n[1] 719\n\n\n\nlength(which(NK_vs_Th$symbol %in% adaptive$gene)) # 513\n\n[1] 513\n\n\n\nupregulated_th &lt;- subset(\n  NK_vs_Th,\n  NK_vs_Th$p.adj &lt;= 0.05 & NK_vs_Th$logFC &lt; 0\n)\n\nnot_significant_genes &lt;- subset(\n  NK_vs_Th,\n  NK_vs_Th$p.adj &gt; 0.05\n)\n\nsummary_upregulated &lt;- summary(upregulated_th$symbol %in% adaptive$gene)\nsummary_not_significant &lt;- summary(not_significant_genes$symbol %in% adaptive$gene)\n\n\ncontingency_table &lt;- matrix(, nrow = 2, ncol = 2)\ncontingency_table[[1]] &lt;- summary_upregulated[[3]] # up, in gene set\ncontingency_table[[2]] &lt;- summary_upregulated[[2]] # up, not in gene set\ncontingency_table[[3]] &lt;- summary_not_significant[[3]] # down, in gene set\ncontingency_table[[4]] &lt;- summary_not_significant[[2]] # down, not in gene set\n\n# Convert to numeric\ncontingency_table &lt;- apply(contingency_table, 2, as.numeric)\n\n# Add rows and columns\ncolnames(contingency_table) &lt;- c(\"up\", \"down\")\nrownames(contingency_table) &lt;- c(\"in_set\", \"not_in_set\")\n\n\nfisher.test(contingency_table)\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  contingency_table\np-value &lt; 2.2e-16\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n 3.697701 5.654348\nsample estimates:\nodds ratio \n  4.580549 \n\n\nThe odds ratio tells us how different the two proportions are.\nIf the confidence interval does not include 1, then p-value is small. We can reject null hypothesis thatthe odds ratio is equal to 1.\nThere are more genes that are upregulated in the gene set than the genes that are not upregulated in the gene set.\n\n# Test 3 gene sets among the genes up-regulated in NK cells,\n# with enricher()\n# First, obtain the genes up-regulated in NK:\n\nnk_up_genes &lt;- subset(NK_vs_Th, NK_vs_Th$logFC &gt; 0 & NK_vs_Th$p.adj &lt;= 0.05)$symbol\n\n# Import 2 other gene sets, 1 un-related to immune cells:\nhair &lt;- read.gmt(\"data/GOBP_HAIR_CELL_DIFFERENTIATION.v7.5.1.gmt\")\ndim(hair)\n\n[1] 47  2\n\ncell_active &lt;- read.gmt(\"data/GOBP_CELL_ACTIVATION.v7.5.1.gmt\")\ndim(cell_active)\n\n[1] 1095    2\n\n# Combine the 3 gene sets into a single data.frame for the TERM2GENE argument:\ngenesets3 &lt;- rbind(adaptive, hair, cell_active)\n\nhyper_3genesets &lt;- enricher(\n  gene = nk_up_genes,\n  universe = NK_vs_Th$symbol,\n  TERM2GENE = genesets3,\n  maxGSSize = 1000\n)\nhyper_3genesets@result\n\n                                                           ID\nGOBP_CELL_ACTIVATION                     GOBP_CELL_ACTIVATION\nGOBP_HAIR_CELL_DIFFERENTIATION GOBP_HAIR_CELL_DIFFERENTIATION\nGOBP_ADAPTIVE_IMMUNE_RESPONSE   GOBP_ADAPTIVE_IMMUNE_RESPONSE\n                                                  Description GeneRatio\nGOBP_CELL_ACTIVATION                     GOBP_CELL_ACTIVATION   173/200\nGOBP_HAIR_CELL_DIFFERENTIATION GOBP_HAIR_CELL_DIFFERENTIATION     5/200\nGOBP_ADAPTIVE_IMMUNE_RESPONSE   GOBP_ADAPTIVE_IMMUNE_RESPONSE    82/200\n                                BgRatio      pvalue    p.adjust      qvalue\nGOBP_CELL_ACTIVATION           896/1138 0.001505054 0.004515163 0.003168535\nGOBP_HAIR_CELL_DIFFERENTIATION  34/1138 0.741306145 0.912609682 0.640427847\nGOBP_ADAPTIVE_IMMUNE_RESPONSE  513/1138 0.912609682 0.912609682 0.640427847\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             geneID\nGOBP_CELL_ACTIVATION           FGR/CD38/SKAP2/ITGAL/TYROBP/RUNX3/NR1H3/SLAMF7/IFNGR1/STAP1/HDAC9/TSPAN32/RHOA/RAB27A/FCGR2B/TBX21/CST7/HOXA9/ITCH/MEF2C/PTPRC/LAT2/ICAM1/SNAP23/ABL1/HMOX1/IL2RB/SOS2/SLA2/NFATC2/MYL9/NBN/LILRB1/NKG7/CD33/PIK3CG/TGFBR1/MAP3K8/P2RX1/PRKAR1A/CTSC/ZBTB16/CRTAM/TCIRG1/LTBR/MAPK14/PDGFRB/BCL6/CD86/CBLB/LOXL3/IGFBP2/IL18R1/ID2/PLEK/PLA2G4A/RAB29/CD160/RPS6KA1/FOXO3/TNFSF11/PTK2B/SASH3/CD244/BTN2A2/SOX4/IRF1/TNFSF14/RAC2/CRACR2A/BST2/THEMIS2/AP3B1/PRAM1/SWAP70/VAV3/PTPN22/KLRC1/HAVCR2/TEC/DYSF/SERPINE2/LCP1/LRRC8A/TLN1/THBS1/ADAM10/MMRN1/PPP3CA/SLC15A4/IRF8/ERBB2/AKT1/XCL1/ILDR2/SOX13/DGKQ/MSN/GSN/CD226/IL18/DLG5/ADAM8/HHEX/CD8A/SH3RF1/KIT/SLAMF8/F11R/FCER1G/ITGB2/FCRL3/TNFSF13/VCAM1/EOMES/PRKCD/CSF2/SYK/NFIL3/ILK/NFKBID/TMIGD2/CD300A/NLRC3/CCDC88B/PTGDR/CX3CR1/INPP5D/PRELID1/P2RY1/ITGAM/LGALS9B/LGALS9C/AZU1/CD7/PTPN2/GAPT/YES1/ZBTB7A/PRF1/CXCR2/F2R/FES/PLCB1/ADGRG3/MRGPRX2/TBK1/JAG2/CD300LF/FANCA/PLSCR1/CNR2/NCR1/HSH2D/SPN/PLCG2/CARD11/SH2D1B/FCGR3A/NCR3/KLRC2/TRDC/IGHA2/IGHA1/CLIC1/KLRK1/LILRA2/HLA-DMB/DDOST/LYN/KLRC4-KLRK1/DGKK/CCL3\nGOBP_HAIR_CELL_DIFFERENTIATION                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     TRIOBP/JAG1/SLC9A3R1/NOTCH1/JAG2\nGOBP_ADAPTIVE_IMMUNE_RESPONSE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         SLAMF7/RAB27A/FCGR2B/PVR/TBX21/STX7/MEF2C/PTPRC/LAT2/ICAM1/SLA2/JAG1/NBN/LILRB1/LILRA1/PIK3CG/CTSC/CRTAM/TCIRG1/TFEB/BCL6/CD86/LOXL3/IL18R1/PLA2G4A/CD160/PTK2B/ADCY7/SASH3/CD244/IRF1/C3/CRACR2A/RFTN1/SWAP70/KLRD1/KLRC1/HAVCR2/TEC/DBNL/SLC15A4/SIGLEC10/XCL1/NOTCH1/CD226/IL18/CD8A/FCER1G/TNFSF13/EOMES/PRKCD/ERAP1/SYK/NFKBID/LAIR1/CX3CR1/INPP5D/CD7/GAPT/C8G/PRF1/SPN/CLEC4C/SH2D1B/FCGR3A/KLRC2/IGLV2-18/IGLV2-11/TRGV9/TRBJ2-1/TRBJ2-2/TRBJ2-3/TRBJ2-4/TRBJ2-7/TRDC/IGHA2/IGHA1/SIPA1/KLRK1/HLA-DMB/LYN/KLRC4-KLRK1\n                               Count\nGOBP_CELL_ACTIVATION             173\nGOBP_HAIR_CELL_DIFFERENTIATION     5\nGOBP_ADAPTIVE_IMMUNE_RESPONSE     82\n\n\n\nsig_genes &lt;- subset(NK_vs_Th, NK_vs_Th$symbol %in% adaptive$gene &\n  NK_vs_Th$p.adj &lt;= 0.05)\nsig_genes_label &lt;- subset(sig_genes, sig_genes$p.adj &lt;= 0.00001)\n\nggplot(NK_vs_Th, aes(\n  x = logFC,\n  y = -log10(p.adj)\n)) +\n  geom_point(color = \"grey87\") +\n  ggtitle(\"Genes belonging to the adaptive immune response gene set\") +\n  theme_bw() +\n  geom_text_repel(\n    data = sig_genes_label,\n    aes(\n      x = logFC,\n      y = -log10(p.adj), label = symbol\n    ),\n    max.overlaps = 20\n  ) +\n  geom_point(data = sig_genes, col = \"dodgerblue2\") +\n  theme(legend.position = \"none\") +\n  scale_x_continuous(name = expression(\"log\"[2] * \"(fold change), NK vs Th cells\")) +\n  scale_y_continuous(name = expression(\"-\" * \"log\"[10] * \"(adj. p-value)\")) +\n  geom_hline(yintercept = -log10(0.05), linetype = \"dashed\") +\n  geom_vline(xintercept = 0, linetype = \"dashed\")\n\nWarning: ggrepel: 46 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps"
  },
  {
    "objectID": "sib_enrichment_analysis_exercises.html#exercise-2---gene-set-enrichment-analysis-gsea",
    "href": "sib_enrichment_analysis_exercises.html#exercise-2---gene-set-enrichment-analysis-gsea",
    "title": "SIB - Enrichment Analysis",
    "section": "Exercise 2 - Gene set enrichment analysis (GSEA)",
    "text": "Exercise 2 - Gene set enrichment analysis (GSEA)\n\ngl &lt;- NK_vs_Th$t\nnames(gl) &lt;- make.names(NK_vs_Th$symbol, unique = T)\ngl &lt;- gl[order(gl, decreasing = T)]\n\nGO_NK_Th &lt;- gseGO(gl,\n  ont = \"BP\",\n  OrgDb = org.Hs.eg.db,\n  keyType = \"SYMBOL\",\n  minGSSize = 30,\n  eps = 0,\n  seed = T\n)\n\npreparing geneSet collections...\n\n\nGSEA analysis...\n\n\nWarning in preparePathwaysAndStats(pathways, stats, minSize, maxSize, gseaParam, : There are ties in the preranked stats (0.07% of the list).\nThe order of those tied genes will be arbitrary, which may produce unexpected results.\n\n\nleading edge analysis...\n\n\ndone...\n\n\n\nGO_NK_Th\n\n#\n# Gene Set Enrichment Analysis\n#\n#...@organism    Homo sapiens \n#...@setType     BP \n#...@keytype     SYMBOL \n#...@geneList    Named num [1:20485] 19 13.1 12.1 12 10.7 ...\n - attr(*, \"names\")= chr [1:20485] \"GHSR\" \"MLC1\" \"SH2D1B\" \"TRGV9\" ...\n#...nPerm    \n#...pvalues adjusted by 'BH' with cutoff &lt;0.05 \n#...351 enriched terms found\n'data.frame':   351 obs. of  11 variables:\n $ ID             : chr  \"GO:0002181\" \"GO:0042254\" \"GO:0022613\" \"GO:0042273\" ...\n $ Description    : chr  \"cytoplasmic translation\" \"ribosome biogenesis\" \"ribonucleoprotein complex biogenesis\" \"ribosomal large subunit biogenesis\" ...\n $ setSize        : int  145 299 436 69 98 57 210 340 111 242 ...\n $ enrichmentScore: num  -0.808 -0.551 -0.491 -0.715 -0.648 ...\n $ NES            : num  -3.38 -2.52 -2.36 -2.67 -2.58 ...\n $ pvalue         : num  1.68e-48 6.30e-24 2.34e-22 1.48e-14 3.84e-14 ...\n $ p.adjust       : num  4.85e-45 9.08e-21 2.25e-19 1.07e-11 2.21e-11 ...\n $ qvalue         : num  3.77e-45 7.05e-21 1.75e-19 8.27e-12 1.72e-11 ...\n $ rank           : num  1385 3723 3746 2698 2371 ...\n $ leading_edge   : chr  \"tags=58%, list=7%, signal=54%\" \"tags=38%, list=18%, signal=32%\" \"tags=34%, list=18%, signal=29%\" \"tags=52%, list=13%, signal=45%\" ...\n $ core_enrichment: chr  \"EIF2S2/EIF3M/RPL21/RPS28/EIF4A2/YBX1/FAU/PKM/RPS9/CNBP/RPL37/RPL37A/UBA52/RPS15/RPL22/RPL27/RPS7/RPS11/RPL35/RP\"| __truncated__ \"UTP23/TMA16/ZNF658/NOB1/WDR43/DHX37/MRPL20/RPS24/EIF2A/ABCE1/RBFA/USP16/METTL16/NOL11/EXOSC8/EXOSC6/TRAF7/LYAR/\"| __truncated__ \"SRSF6/UTP23/TMA16/ZNF658/SRPK1/NOB1/WDR43/DHX37/MRPL20/RPS24/EIF2A/SF3B5/ABCE1/PTBP2/RBFA/USP16/METTL16/NOL11/S\"| __truncated__ \"ZNHIT3/SDAD1/MRTO4/RPL26L1/RPLP0P6/FASTKD2/NHP2/NOP16/RSL24D1/PES1/DHX30/WDR74/MALSU1/RSL1D1/NOL9/DDX18/NSA2/GT\"| __truncated__ ...\n#...Citation\n T Wu, E Hu, S Xu, M Chen, P Guo, Z Dai, T Feng, L Zhou, W Tang, L Zhan, X Fu, S Liu, X Bo, and G Yu.\n clusterProfiler 4.0: A universal enrichment tool for interpreting omics data.\n The Innovation. 2021, 2(3):100141 \n\n# Class is gseaResult\nclass(GO_NK_Th)\n\n[1] \"gseaResult\"\nattr(,\"package\")\n[1] \"DOSE\"\n\n# Is the adaptive immune response gene set significant?\nGO_NK_Th[GO_NK_Th@result$Description == \"adaptive immune response\", ] # yes\n\n                   ID              Description setSize enrichmentScore\nGO:0002250 GO:0002250 adaptive immune response     423      -0.3652034\n                 NES       pvalue     p.adjust       qvalue rank\nGO:0002250 -1.743904 1.001619e-08 1.804167e-06 1.400949e-06 1623\n                            leading_edge\nGO:0002250 tags=23%, list=8%, signal=22%\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    core_enrichment\nGO:0002250 HFE/CD3E/CLU/PDCD1LG2/ADGRE1/JAK3/LEF1/IL18BP/ITK/CD80/ALCAM/TRAV34/AIRE/IGHM/BTLA/CR1/C1QBP/CD3G/CTSL/TRAJ42/TRBV16/TNF/CEACAM1/GPR183/CD27/CCR6/ICOSLG/TRDV1/CCR2/CD6/TRBD1/MCOLN2/TRAV14DV4/IL2/CR2/TRAV22/CD70/PDCD1/MALT1/EBAG9/TRAV30/CTLA4/TRAV23DV6/TNFRSF13C/KDM5D/TRAV40/TRAV18/IL6R/CD3D/TRAJ3/TRAV39/TRBC2/SAMSN1/IL7R/TRAV19/SUSD4/TRAV20/CD84/TRAV10/TRAV21/TRBV13/TRAV41/TRAV29DV5/NDFIP1/TRAV36DV7/THEMIS/TRBV18/TRAT1/SOCS3/IL6ST/TRBV9/TRAV24/TRAV3/TRAV27/TRAV4/TRAV6/TRAV2/TRAV5/JUNB/TRBV19/TRAV35/TRBV30/FOXP3/TRAV16/IL23A/TRBV2/TRBV14/PAG1/CD4/TRAV25/SIT1/TRAV17/CD40LG/CAMK4/TRAC/CD28/SLAMF1\n\n# How many gene sets are down- or up-regulated?\ncount_gene_sets &lt;- function(gsea, p_value) {\n  up &lt;- summary(gsea@result$p.adjust &lt; p_value & gsea@result$NES &gt; 0)\n  down &lt;- summary(gsea@result$p.adjust &lt; p_value & gsea@result$NES &lt; 0)\n\n  return(list(upregulated = up, downregulated = down))\n}\n\n# 290 upregulated, 61 downregulated\ncount_gene_sets(GO_NK_Th, 0.05)\n\n$upregulated\n   Mode   FALSE    TRUE \nlogical      61     290 \n\n$downregulated\n   Mode   FALSE    TRUE \nlogical     290      61 \n\n\n\nGO_NK_Th_simplify &lt;- clusterProfiler::simplify(GO_NK_Th)\nGO_NK_Th_simplify@result[GO_NK_Th_simplify@result$Description == \"adaptive immune response\", ]\n\n                   ID              Description setSize enrichmentScore\nGO:0002250 GO:0002250 adaptive immune response     423      -0.3652034\n                 NES       pvalue     p.adjust       qvalue rank\nGO:0002250 -1.743904 1.001619e-08 1.804167e-06 1.400949e-06 1623\n                            leading_edge\nGO:0002250 tags=23%, list=8%, signal=22%\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    core_enrichment\nGO:0002250 HFE/CD3E/CLU/PDCD1LG2/ADGRE1/JAK3/LEF1/IL18BP/ITK/CD80/ALCAM/TRAV34/AIRE/IGHM/BTLA/CR1/C1QBP/CD3G/CTSL/TRAJ42/TRBV16/TNF/CEACAM1/GPR183/CD27/CCR6/ICOSLG/TRDV1/CCR2/CD6/TRBD1/MCOLN2/TRAV14DV4/IL2/CR2/TRAV22/CD70/PDCD1/MALT1/EBAG9/TRAV30/CTLA4/TRAV23DV6/TNFRSF13C/KDM5D/TRAV40/TRAV18/IL6R/CD3D/TRAJ3/TRAV39/TRBC2/SAMSN1/IL7R/TRAV19/SUSD4/TRAV20/CD84/TRAV10/TRAV21/TRBV13/TRAV41/TRAV29DV5/NDFIP1/TRAV36DV7/THEMIS/TRBV18/TRAT1/SOCS3/IL6ST/TRBV9/TRAV24/TRAV3/TRAV27/TRAV4/TRAV6/TRAV2/TRAV5/JUNB/TRBV19/TRAV35/TRBV30/FOXP3/TRAV16/IL23A/TRBV2/TRBV14/PAG1/CD4/TRAV25/SIT1/TRAV17/CD40LG/CAMK4/TRAC/CD28/SLAMF1\n\n\n\nunlist(strsplit(\n  GO_NK_Th@result[GO_NK_Th@result$Description == \"adaptive immune response\", 11],\n  \"\\\\/\"\n))\n\n [1] \"HFE\"       \"CD3E\"      \"CLU\"       \"PDCD1LG2\"  \"ADGRE1\"    \"JAK3\"     \n [7] \"LEF1\"      \"IL18BP\"    \"ITK\"       \"CD80\"      \"ALCAM\"     \"TRAV34\"   \n[13] \"AIRE\"      \"IGHM\"      \"BTLA\"      \"CR1\"       \"C1QBP\"     \"CD3G\"     \n[19] \"CTSL\"      \"TRAJ42\"    \"TRBV16\"    \"TNF\"       \"CEACAM1\"   \"GPR183\"   \n[25] \"CD27\"      \"CCR6\"      \"ICOSLG\"    \"TRDV1\"     \"CCR2\"      \"CD6\"      \n[31] \"TRBD1\"     \"MCOLN2\"    \"TRAV14DV4\" \"IL2\"       \"CR2\"       \"TRAV22\"   \n[37] \"CD70\"      \"PDCD1\"     \"MALT1\"     \"EBAG9\"     \"TRAV30\"    \"CTLA4\"    \n[43] \"TRAV23DV6\" \"TNFRSF13C\" \"KDM5D\"     \"TRAV40\"    \"TRAV18\"    \"IL6R\"     \n[49] \"CD3D\"      \"TRAJ3\"     \"TRAV39\"    \"TRBC2\"     \"SAMSN1\"    \"IL7R\"     \n[55] \"TRAV19\"    \"SUSD4\"     \"TRAV20\"    \"CD84\"      \"TRAV10\"    \"TRAV21\"   \n[61] \"TRBV13\"    \"TRAV41\"    \"TRAV29DV5\" \"NDFIP1\"    \"TRAV36DV7\" \"THEMIS\"   \n[67] \"TRBV18\"    \"TRAT1\"     \"SOCS3\"     \"IL6ST\"     \"TRBV9\"     \"TRAV24\"   \n[73] \"TRAV3\"     \"TRAV27\"    \"TRAV4\"     \"TRAV6\"     \"TRAV2\"     \"TRAV5\"    \n[79] \"JUNB\"      \"TRBV19\"    \"TRAV35\"    \"TRBV30\"    \"FOXP3\"     \"TRAV16\"   \n[85] \"IL23A\"     \"TRBV2\"     \"TRBV14\"    \"PAG1\"      \"CD4\"       \"TRAV25\"   \n[91] \"SIT1\"      \"TRAV17\"    \"CD40LG\"    \"CAMK4\"     \"TRAC\"      \"CD28\"     \n[97] \"SLAMF1\"   \n\n\n\nGO_NK_Th@geneSets$`GO:0002250`\n\n  [1] \"ADA\"         \"ADCY7\"       \"AGER\"        \"JAG1\"        \"AHR\"        \n  [6] \"ALCAM\"       \"ALOX15\"      \"ANXA1\"       \"AIRE\"        \"ARG1\"       \n [11] \"ARG2\"        \"ASCL2\"       \"B2M\"         \"BCL3\"        \"BCL6\"       \n [16] \"TNFRSF17\"    \"CEACAM1\"     \"PRDM1\"       \"BMX\"         \"BTK\"        \n [21] \"C1QBP\"       \"SERPING1\"    \"C1QA\"        \"C1QB\"        \"C1QC\"       \n [26] \"C1R\"         \"C1S\"         \"C2\"          \"C3\"          \"C4A\"        \n [31] \"C4B\"         \"C4BPA\"       \"C4BPB\"       \"C5\"          \"C6\"         \n [36] \"C7\"          \"C8A\"         \"C8B\"         \"C8G\"         \"C9\"         \n [41] \"CAMK4\"       \"CD1A\"        \"CD1B\"        \"CD1C\"        \"CD1D\"       \n [46] \"CD1E\"        \"CD3D\"        \"CD3E\"        \"CD3G\"        \"CD247\"      \n [51] \"CD4\"         \"CD6\"         \"CD7\"         \"CD8A\"        \"CD8B\"       \n [56] \"CD8B2\"       \"CD19\"        \"CD27\"        \"CD28\"        \"CD80\"       \n [61] \"CD86\"        \"CD40\"        \"CD40LG\"      \"CD70\"        \"CD74\"       \n [66] \"CD79A\"       \"CD79B\"       \"CD81\"        \"CTSC\"        \"CLC\"        \n [71] \"CLU\"         \"CCR6\"        \"CR1\"         \"CR1L\"        \"CR2\"        \n [76] \"CSF2RB\"      \"CSK\"         \"CTLA4\"       \"CTSH\"        \"CTSL\"       \n [81] \"CTSS\"        \"CX3CR1\"      \"CD55\"        \"GPR183\"      \"EMP2\"       \n [86] \"ADGRE1\"      \"EPHB2\"       \"ERCC1\"       \"PTK2B\"       \"FCER1A\"     \n [91] \"FCER1G\"      \"FCER2\"       \"FCGR1A\"      \"FCGR1BP\"     \"FCGR2B\"     \n [96] \"FCGR3A\"      \"FGA\"         \"FGB\"         \"FGL1\"        \"FOXJ1\"      \n[101] \"MTOR\"        \"FUT7\"        \"FYN\"         \"GATA3\"       \"GNL1\"       \n[106] \"MSH6\"        \"GZMM\"        \"NCKAP1L\"     \"HFE\"         \"HLA-A\"      \n[111] \"HLA-B\"       \"HLA-C\"       \"HLA-DMA\"     \"HLA-DMB\"     \"HLA-DOA\"    \n[116] \"HLA-DOB\"     \"HLA-DPA1\"    \"HLA-DPB1\"    \"HLA-DQA1\"    \"HLA-DQA2\"   \n[121] \"HLA-DQB1\"    \"HLA-DQB2\"    \"HLA-DRA\"     \"HLA-DRB1\"    \"HLA-DRB3\"   \n[126] \"HLA-DRB4\"    \"HLA-DRB5\"    \"HLA-E\"       \"HLA-F\"       \"HLA-G\"      \n[131] \"HLA-H\"       \"MR1\"         \"HLX\"         \"HMGB1\"       \"HPRT1\"      \n[136] \"HPX\"         \"HRAS\"        \"HSPD1\"       \"ICAM1\"       \"CFI\"        \n[141] \"IFNA1\"       \"IFNA2\"       \"IFNA4\"       \"IFNA5\"       \"IFNA6\"      \n[146] \"IFNA7\"       \"IFNA8\"       \"IFNA10\"      \"IFNA13\"      \"IFNA14\"     \n[151] \"IFNA16\"      \"IFNA17\"      \"IFNA21\"      \"IFNB1\"       \"IFNG\"       \n[156] \"IFNW1\"       \"IGHA1\"       \"IGHA2\"       \"IGHD\"        \"IGHE\"       \n[161] \"IGHG1\"       \"IGHG2\"       \"IGHG3\"       \"IGHG4\"       \"IGHM\"       \n[166] \"JCHAIN\"      \"IGKC\"        \"IGLC1\"       \"IGLC2\"       \"IGLC3\"      \n[171] \"IGLC6\"       \"IGLL1\"       \"IL1B\"        \"IL1R1\"       \"IL2\"        \n[176] \"IL2RB\"       \"IL4\"         \"IL4R\"        \"IL6\"         \"IL6R\"       \n[181] \"IL6ST\"       \"IL7R\"        \"IL9\"         \"IL9R\"        \"IL10\"       \n[186] \"IL12A\"       \"IL12B\"       \"IL12RB1\"     \"IL13RA2\"     \"IL17A\"      \n[191] \"IL18\"        \"INPP5D\"      \"IRF1\"        \"IRF4\"        \"IRF7\"       \n[196] \"ITK\"         \"JAK1\"        \"JAK2\"        \"JAK3\"        \"JUNB\"       \n[201] \"KCNJ8\"       \"KLRC1\"       \"KLRC2\"       \"KLRD1\"       \"LAG3\"       \n[206] \"LAIR1\"       \"LIG4\"        \"LTA\"         \"LY9\"         \"LYN\"        \n[211] \"SH2D1A\"      \"SMAD7\"       \"MBL2\"        \"CD46\"        \"MEF2C\"      \n[216] \"MICB\"        \"MLH1\"        \"MPL\"         \"MSH2\"        \"MYD88\"      \n[221] \"NBN\"         \"NFKB2\"       \"NOTCH1\"      \"P2RX7\"       \"PDCD1\"      \n[226] \"PHB1\"        \"PIK3CD\"      \"PIK3CG\"      \"PLA2G4A\"     \"PMS2\"       \n[231] \"PPP3CB\"      \"PRF1\"        \"PRKCB\"       \"PRKCD\"       \"PKN1\"       \n[236] \"PRKCQ\"       \"PRKCZ\"       \"PSG9\"        \"PTPN6\"       \"PTPRC\"      \n[241] \"PVR\"         \"NECTIN2\"     \"RAB27A\"      \"RAG1\"        \"RAP1GAP\"    \n[246] \"RELB\"        \"TRIM27\"      \"RORA\"        \"RORC\"        \"CCL19\"      \n[251] \"XCL1\"        \"SIPA1\"       \"SLAMF1\"      \"SLC11A1\"     \"SPN\"        \n[256] \"STAT3\"       \"STAT4\"       \"STAT6\"       \"SUPT6H\"      \"SYK\"        \n[261] \"ADAM17\"      \"MAP3K7\"      \"TAP1\"        \"TAP2\"        \"TRA\"        \n[266] \"TRAV6\"       \"TRB\"         \"TRGC1\"       \"TRGC2\"       \"TRGV1\"      \n[271] \"TRGV2\"       \"TRGV3\"       \"TRGV4\"       \"TRGV5\"       \"TRGV8\"      \n[276] \"TRGV9\"       \"TRGV10\"      \"TRGV11\"      \"TEC\"         \"TFE3\"       \n[281] \"TFRC\"        \"TGFB1\"       \"TLR4\"        \"TNF\"         \"TNFAIP3\"    \n[286] \"TNFRSF1B\"    \"TP53BP1\"     \"TRAF2\"       \"TRAF6\"       \"TSC1\"       \n[291] \"TNFSF4\"      \"TXK\"         \"TYK2\"        \"UNG\"         \"WAS\"        \n[296] \"LAT2\"        \"NSD2\"        \"ZAP70\"       \"ZP3\"         \"FZD5\"       \n[301] \"TFEB\"        \"KDM5D\"       \"EOMES\"       \"STX7\"        \"SKAP1\"      \n[306] \"TNFSF13\"     \"TNFRSF14\"    \"RIPK2\"       \"FADD\"        \"TNFRSF11A\"  \n[311] \"IL18R1\"      \"CD84\"        \"BCL10\"       \"TNFSF18\"     \"SOCS3\"      \n[316] \"RNF8\"        \"EXO1\"        \"EBAG9\"       \"IL1RL1\"      \"SLC22A13\"   \n[321] \"IL27RA\"      \"SOCS5\"       \"THOC1\"       \"PARP3\"       \"IL18BP\"     \n[326] \"EBI3\"        \"LILRB2\"      \"TCIRG1\"      \"CLEC4M\"      \"BTN3A3\"     \n[331] \"RAPGEF3\"     \"MAD2L2\"      \"CLEC10A\"     \"BATF\"        \"CXCL13\"     \n[336] \"CD226\"       \"TNFSF13B\"    \"MASP2\"       \"TRAF3IP2\"    \"LILRB1\"     \n[341] \"ARID5A\"      \"MALT1\"       \"LILRB5\"      \"LILRB4\"      \"LILRA1\"     \n[346] \"LILRB3\"      \"LILRA3\"      \"RIPK3\"       \"RAPGEF4\"     \"BTN3A2\"     \n[351] \"BTN3A1\"      \"CD160\"       \"DUSP10\"      \"TREX1\"       \"ZBTB1\"      \n[356] \"KLRK1\"       \"PAXIP1\"      \"SWAP70\"      \"RAP1GAP2\"    \"RFTN1\"      \n[361] \"ICOSLG\"      \"SIRT1\"       \"TNFRSF13B\"   \"CLCF1\"       \"IL17RA\"     \n[366] \"PRKD2\"       \"TMEM98\"      \"LAT\"         \"LAMP3\"       \"SIT1\"       \n[371] \"TNFRSF21\"    \"IGKV1-5\"     \"IGHV8-51-1\"  \"IGHV7-81\"    \"IGHV6-1\"    \n[376] \"IGHV5-10-1\"  \"IGHV5-51\"    \"IGHV4-38-2\"  \"IGHV4-61\"    \"IGHV4-59\"   \n[381] \"IGHV4-39\"    \"IGHV4-34\"    \"IGHV4-31\"    \"IGHV4-30-4\"  \"IGHV4-28\"   \n[386] \"IGHV4-4\"     \"IGHV3-38-3\"  \"IGHV3-74\"    \"IGHV3-73\"    \"IGHV3-72\"   \n[391] \"IGHV3-66\"    \"IGHV3-64\"    \"IGHV3-53\"    \"IGHV3-49\"    \"IGHV3-48\"   \n[396] \"IGHV3-43\"    \"IGHV3-38\"    \"IGHV3-35\"    \"IGHV3-33\"    \"IGHV3-30\"   \n[401] \"IGHV3-23\"    \"IGHV3-21\"    \"IGHV3-20\"    \"IGHV3-16\"    \"IGHV3-15\"   \n[406] \"IGHV3-13\"    \"IGHV3-11\"    \"IGHV3-9\"     \"IGHV3-7\"     \"IGHV2-70\"   \n[411] \"IGHV2-26\"    \"IGHV2-5\"     \"IGHV1-69-2\"  \"IGHV1-38-4\"  \"IGHV1-69\"   \n[416] \"IGHV1-58\"    \"IGHV1-45\"    \"IGHV1-24\"    \"IGHV1-18\"    \"IGHV1-8\"    \n[421] \"IGHV1-3\"     \"IGHJ1\"       \"IGHD1-1\"     \"TRDV3\"       \"TRDV2\"      \n[426] \"TRDV1\"       \"TRDJ1\"       \"TRDD1\"       \"TRDC\"        \"TRBV30\"     \n[431] \"TRBV29-1\"    \"TRBV28\"      \"TRBV27\"      \"TRBV25-1\"    \"TRBV24-1\"   \n[436] \"TRBV23-1\"    \"TRBV20-1\"    \"TRBV19\"      \"TRBV18\"      \"TRBV17\"     \n[441] \"TRBV16\"      \"TRBV14\"      \"TRBV13\"      \"TRBV12-5\"    \"TRBV12-4\"   \n[446] \"TRBV12-3\"    \"TRBV11-3\"    \"TRBV11-2\"    \"TRBV11-1\"    \"TRBV10-3\"   \n[451] \"TRBV10-2\"    \"TRBV10-1\"    \"TRBV9\"       \"TRBV7-9\"     \"TRBV7-8\"    \n[456] \"TRBV7-7\"     \"TRBV7-6\"     \"TRBV7-4\"     \"TRBV7-3\"     \"TRBV7-2\"    \n[461] \"TRBV7-1\"     \"TRBV6-9\"     \"TRBV6-8\"     \"TRBV6-7\"     \"TRBV6-6\"    \n[466] \"TRBV6-5\"     \"TRBV6-4\"     \"TRBV6-3\"     \"TRBV6-1\"     \"TRBV5-8\"    \n[471] \"TRBV5-7\"     \"TRBV5-6\"     \"TRBV5-5\"     \"TRBV5-4\"     \"TRBV5-3\"    \n[476] \"TRBV5-1\"     \"TRBV4-3\"     \"TRBV4-2\"     \"TRBV4-1\"     \"TRBV3-1\"    \n[481] \"TRBV2\"       \"TRBJ2-7\"     \"TRBJ2-6\"     \"TRBJ2-5\"     \"TRBJ2-4\"    \n[486] \"TRBJ2-3\"     \"TRBJ2-2\"     \"TRBJ2-1\"     \"TRBJ1-6\"     \"TRBJ1-5\"    \n[491] \"TRBJ1-4\"     \"TRBJ1-3\"     \"TRBJ1-2\"     \"TRBJ1-1\"     \"TRBD1\"      \n[496] \"TRBC2\"       \"TRBC1\"       \"TRAV41\"      \"TRAV40\"      \"TRAV39\"     \n[501] \"TRAV38-2DV8\" \"TRAV38-1\"    \"TRAV36DV7\"   \"TRAV35\"      \"TRAV34\"     \n[506] \"TRAV30\"      \"TRAV29DV5\"   \"TRAV27\"      \"TRAV26-2\"    \"TRAV26-1\"   \n[511] \"TRAV25\"      \"TRAV24\"      \"TRAV23DV6\"   \"TRAV22\"      \"TRAV21\"     \n[516] \"TRAV20\"      \"TRAV19\"      \"TRAV18\"      \"TRAV17\"      \"TRAV16\"     \n[521] \"TRAV14DV4\"   \"TRAV13-2\"    \"TRAV13-1\"    \"TRAV12-3\"    \"TRAV12-2\"   \n[526] \"TRAV12-1\"    \"TRAV10\"      \"TRAV9-2\"     \"TRAV9-1\"     \"TRAV8-6\"    \n[531] \"TRAV8-4\"     \"TRAV8-3\"     \"TRAV8-2\"     \"TRAV8-1\"     \"TRAV7\"      \n[536] \"TRAV5\"       \"TRAV4\"       \"TRAV3\"       \"TRAV2\"       \"TRAV1-2\"    \n[541] \"TRAV1-1\"     \"TRAJ42\"      \"TRAJ31\"      \"TRAJ3\"       \"TRAC\"       \n[546] \"IGLV11-55\"   \"IGLV10-54\"   \"IGLV9-49\"    \"IGLV8-61\"    \"IGLV7-46\"   \n[551] \"IGLV7-43\"    \"IGLV6-57\"    \"IGLV5-52\"    \"IGLV5-48\"    \"IGLV5-45\"   \n[556] \"IGLV5-39\"    \"IGLV5-37\"    \"IGLV4-69\"    \"IGLV4-60\"    \"IGLV4-3\"    \n[561] \"IGLV3-32\"    \"IGLV3-27\"    \"IGLV3-25\"    \"IGLV3-22\"    \"IGLV3-21\"   \n[566] \"IGLV3-19\"    \"IGLV3-16\"    \"IGLV3-12\"    \"IGLV3-10\"    \"IGLV3-9\"    \n[571] \"IGLV3-1\"     \"IGLV2-33\"    \"IGLV2-23\"    \"IGLV2-18\"    \"IGLV2-14\"   \n[576] \"IGLV2-11\"    \"IGLV2-8\"     \"IGLV1-51\"    \"IGLV1-50\"    \"IGLV1-47\"   \n[581] \"IGLV1-44\"    \"IGLV1-40\"    \"IGLV1-36\"    \"IGLJ1\"       \"IGLC7\"      \n[586] \"IGKV6D-41\"   \"IGKV6D-21\"   \"IGKV3D-20\"   \"IGKV3D-15\"   \"IGKV3D-11\"  \n[591] \"IGKV3D-7\"    \"IGKV2D-30\"   \"IGKV2D-29\"   \"IGKV2D-28\"   \"IGKV2D-26\"  \n[596] \"IGKV2D-24\"   \"IGKV1D-43\"   \"IGKV1D-42\"   \"IGKV1D-39\"   \"IGKV1D-37\"  \n[601] \"IGKV1D-33\"   \"IGKV1D-17\"   \"IGKV1D-13\"   \"IGKV1D-12\"   \"IGKV1D-8\"   \n[606] \"IGKV6-21\"    \"IGKV5-2\"     \"IGKV4-1\"     \"IGKV3-20\"    \"IGKV3-15\"   \n[611] \"IGKV3-7\"     \"IGKV2-40\"    \"IGKV2-30\"    \"IGKV2-29\"    \"IGKV2-28\"   \n[616] \"IGKV2-24\"    \"IGKV1-39\"    \"IGKV1-37\"    \"IGKV1-27\"    \"IGKV1-17\"   \n[621] \"IGKV1-16\"    \"IGKV1-13\"    \"IGKV1-12\"    \"IGKV1-9\"     \"IGKV1-8\"    \n[626] \"IGKV1-6\"     \"IGKJ1\"       \"DBNL\"        \"PYCARD\"      \"CD274\"      \n[631] \"TBX21\"       \"CD209\"       \"IL21R\"       \"TRAT1\"       \"CLEC4A\"     \n[636] \"FOXP3\"       \"EXOSC3\"      \"ZBTB7B\"      \"KMT5B\"       \"LEF1\"       \n[641] \"C1RL\"        \"TLR8\"        \"IL23A\"       \"CYRIB\"       \"CD244\"      \n[646] \"ERAP1\"       \"IL20RB\"      \"TREM2\"       \"TREM1\"       \"SASH3\"      \n[651] \"SHLD2\"       \"RC3H2\"       \"TRPM4\"       \"LAX1\"        \"LIME1\"      \n[656] \"RNF125\"      \"SUSD4\"       \"AKIRIN2\"     \"RIF1\"        \"OTUB1\"      \n[661] \"PAG1\"        \"CTNNBL1\"     \"IFNK\"        \"DUSP22\"      \"HMCES\"      \n[666] \"OTUD7B\"      \"ENTPD7\"      \"MCOLN1\"      \"IGHV7-4-1\"   \"IGHV3-30-3\" \n[671] \"AICDA\"       \"SLAMF7\"      \"HMHB1\"       \"BACH2\"       \"MYO1G\"      \n[676] \"SAMSN1\"      \"NOD2\"        \"ERAP2\"       \"CARD9\"       \"SEMA4A\"     \n[681] \"NFKBIZ\"      \"DCLRE1C\"     \"CLEC7A\"      \"LILRA6\"      \"ULBP3\"      \n[686] \"VTCN1\"       \"BTNL8\"       \"ATAD5\"       \"SVEP1\"       \"ZC3H12A\"    \n[691] \"ULBP2\"       \"ULBP1\"       \"PDCD1LG2\"    \"PRR7\"        \"NDFIP1\"     \n[696] \"FBXO38\"      \"UNC93B1\"     \"FCRL4\"       \"JAM3\"        \"FCAMR\"      \n[701] \"SLA2\"        \"SANBR\"       \"LOXL3\"       \"CRACR2A\"     \"KMT5C\"      \n[706] \"NFKBID\"      \"HAVCR2\"      \"ORAI1\"       \"IGHV3-30-5\"  \"SIGLEC10\"   \n[711] \"KLHL6\"       \"IL33\"        \"RSAD2\"       \"CLEC6A\"      \"IL17F\"      \n[716] \"NLRP3\"       \"SLAMF6\"      \"TNFRSF13C\"   \"SH2D1B\"      \"EXOSC6\"     \n[721] \"SLC15A4\"     \"RNF19B\"      \"RAET1E\"      \"RC3H1\"       \"IL23R\"      \n[726] \"SHLD1\"       \"BTLA\"        \"RAET1L\"      \"DENND1B\"     \"RNF168\"     \n[731] \"CLEC4C\"      \"APLF\"        \"UNC13D\"      \"GAPT\"        \"MARCHF8\"    \n[736] \"IL27\"        \"MCOLN2\"      \"ZNF683\"      \"IL4I1\"       \"NLRP10\"     \n[741] \"CLEC4D\"      \"IFNE\"        \"CLEC4G\"      \"RAET1G\"      \"NCR3LG1\"    \n[746] \"THEMIS\"      \"MIR21\"       \"EIF2AK4\"     \"TARM1\"       \"SCART1\"     \n[751] \"CCR2\"        \"C17orf99\"    \"IGLL5\"       \"MICA\"        \"KLRC4-KLRK1\"\n[756] \"IGHV2-70D\"   \"IGHV1-69D\"   \"IGHV3-64D\"   \"IGHV3-43D\"   \"SHLD3\"      \n\n\n\nGO_enrich &lt;- enrichGO(\n  gene = nk_up_genes,\n  OrgDb = org.Hs.eg.db,\n  keyType = \"SYMBOL\",\n  ont = \"MF\", # ont=\"MF\" is the default\n  minGSSize = 30, universe = NK_vs_Th$symbol\n)"
  },
  {
    "objectID": "sib_enrichment_analysis_exercises.html#exercise-3---visualization-of-enrichment-results",
    "href": "sib_enrichment_analysis_exercises.html#exercise-3---visualization-of-enrichment-results",
    "title": "SIB - Enrichment Analysis",
    "section": "Exercise 3 - Visualization of enrichment results",
    "text": "Exercise 3 - Visualization of enrichment results\n\npar(mar = c(5, 20, 3, 3))\nbarplot(rev(-log10(GO_NK_Th@result$p.adjust[1:10])),\n  horiz = T, names = rev(GO_NK_Th@result$Description[1:10]),\n  las = 2, xlab = \"-log10(adj.p-value)\",\n  cex.names = 0.7,\n  col = \"lightgreen\"\n)\nabline(v = -log10(0.05))\n\n\n\n\n\n\n\n\n\nsorted_GO_NK_Th &lt;- GO_NK_Th@result[order(GO_NK_Th@result$NES, decreasing = F), ]\nsorted_GO_NK_Th$colors &lt;- ifelse(sorted_GO_NK_Th$NES &gt; 0, \"red\", \"blue\")\n\n# Get the indices of the vector\nbottom_values &lt;- tail(seq_along(sorted_GO_NK_Th$NES), 10)\n\npar(mar = c(5, 15, 3, 3)) # Make the figure canvas larger\nbarplot(sorted_GO_NK_Th$NES[c(1:10, bottom_values:nrow(sorted_GO_NK_Th))],\n  horiz = T, names = sorted_GO_NK_Th$Description[c(1:10, bottom_values:nrow(sorted_GO_NK_Th))],\n  las = 2, xlab = \"NES\",\n  cex.names = 0.7,\n  col = sorted_GO_NK_Th$color[c(1:10, (nrow(sorted_GO_NK_Th) - 9):nrow(sorted_GO_NK_Th))]\n)\n\nWarning in bottom_values:nrow(sorted_GO_NK_Th): numerical expression has 10\nelements: only the first used\n\nWarning in bottom_values:nrow(sorted_GO_NK_Th): numerical expression has 10\nelements: only the first used\n\nabline(v = 0)\n\n\n\n\n\n\n\n\n\n# Use the GO_enrich analysis performed above, of the over-representation analysis\n# of genes up-regulated in NK cells:\n# barplot() can be directly used on enrichResult objects: but not on gseaResult objects\ngraphics::barplot(GO_enrich)\n\n\n\n\n\n\n\ngraphics::barplot(GO_enrich, color = \"qvalue\", x = \"GeneRatio\")\n\n\n\n\n\n\n\n# Select only 2 out of the significant gene sets:\nego_selection &lt;- GO_enrich[GO_enrich@result$ID == \"GO:0042287\" | GO_enrich@result$ID == \"GO:0004713\", asis = T]\nbarplot(ego_selection)\n\n\n\n\n\n\n\n\n\n# Barcode plot\n# You need the ID of the GO gene set to plot:\nGO_NK_Th@result[1:10, 1:6]\n\n                   ID                          Description setSize\nGO:0002181 GO:0002181              cytoplasmic translation     145\nGO:0042254 GO:0042254                  ribosome biogenesis     299\nGO:0022613 GO:0022613 ribonucleoprotein complex biogenesis     436\nGO:0042273 GO:0042273   ribosomal large subunit biogenesis      69\nGO:0042274 GO:0042274   ribosomal small subunit biogenesis      98\nGO:0042255 GO:0042255                    ribosome assembly      57\nGO:0006364 GO:0006364                      rRNA processing     210\nGO:0002443 GO:0002443          leukocyte mediated immunity     340\nGO:0001909 GO:0001909      leukocyte mediated cytotoxicity     111\nGO:0016072 GO:0016072               rRNA metabolic process     242\n           enrichmentScore       NES       pvalue\nGO:0002181      -0.8083663 -3.375135 1.684522e-48\nGO:0042254      -0.5505406 -2.519660 6.298394e-24\nGO:0022613      -0.4906673 -2.357458 2.339798e-22\nGO:0042273      -0.7146074 -2.668647 1.478487e-14\nGO:0042274      -0.6484741 -2.580517 3.835801e-14\nGO:0042255      -0.7361084 -2.671760 2.555521e-13\nGO:0006364      -0.5004485 -2.197559 1.614149e-12\nGO:0002443       0.4169045  1.955354 6.943557e-11\nGO:0001909       0.5720092  2.333365 1.381646e-10\nGO:0016072      -0.4491031 -2.021848 8.811745e-10\n\n# For a gene set that is down-regulated in NK cells:\ngseaplot(GO_NK_Th,\n  geneSetID = \"GO:0002181\",\n  title = \"GO:0002181 - cytoplasmic translation\"\n)\n\n\n\n\n\n\n\n# And one that is up-regulated in NK cells\ngseaplot(GO_NK_Th,\n  geneSetID = \"GO:0002443\",\n  title = \"GO:0002443 - leukocyte mediated immunity\"\n)\n\n\n\n\n\n\n\n\n\nenrichplot::dotplot(GO_enrich, orderBy = \"p.adjust\")\n\n\n\n\n\n\n\nenrichplot::dotplot(GO_NK_Th, orderBy = \"p.adjust\")\n\n\n\n\n\n\n\n\n\ncnetplot(GO_enrich, categorySize = \"pvalue\")\n\nWarning: ggrepel: 68 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps\n\n\n\n\n\n\n\n\ncnetplot(GO_NK_Th, showCategory = 3)\n\nWarning: ggrepel: 80 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps\n\n\n\n\n\n\n\n\n\n\nego2 &lt;- pairwise_termsim(GO_NK_Th)\nemapplot(ego2, color = \"p.adjust\")\n\n\n\n\n\n\n\n\n\n# Wrap lenght of labels\nlabel_format &lt;- 50\n\n# Distribution of t-statistic for genes included in significant gene sets or in selected gene sets:\nridgeplot(GO_NK_Th, label_format = label_format)\n\nPicking joint bandwidth of 0.787\n\n\n\n\n\n\n\n\n# What is the difference with core_enrichment =F?\nridgeplot(GO_NK_Th, core_enrichment = FALSE, label_format = label_format)\n\nPicking joint bandwidth of 0.975\n\n\n\n\n\n\n\n\n# Select which GO terms to show in the ridge plot:\nGO_NK_Th_selection_1 &lt;- GO_NK_Th[GO_NK_Th$ID == \"GO:0002181\", asis = TRUE]\nGO_NK_Th_selection_3 &lt;- GO_NK_Th[\n  GO_NK_Th$ID %in% c(\n    \"GO:0002181\", \"GO:0022613\",\n    \"GO:0042254\"\n  ),\n  asis = TRUE\n]\n\n# Terms that contain the keyword \"leukocyte\"\nGO_NK_Th_selection &lt;- GO_NK_Th[grep(\"leukocyte\", GO_NK_Th@result$Description), asis = TRUE]\nridgeplot(GO_NK_Th_selection, label_format = label_format)\n\nPicking joint bandwidth of 0.839\n\n\n\n\n\n\n\n\n\n\nridgeplot(GO_NK_Th_selection_1)\n\nPicking joint bandwidth of 0.423\n\n\n\n\n\n\n\n\nridgeplot(GO_NK_Th_selection_3)\n\nPicking joint bandwidth of 0.589"
  },
  {
    "objectID": "sib_enrichment_analysis_exercises.html#exercise-4---enrichment-of-other-collections-of-gene-sets",
    "href": "sib_enrichment_analysis_exercises.html#exercise-4---enrichment-of-other-collections-of-gene-sets",
    "title": "SIB - Enrichment Analysis",
    "section": "Exercise 4 - Enrichment of other collections of gene sets",
    "text": "Exercise 4 - Enrichment of other collections of gene sets\n\nkeytypes(org.Hs.eg.db)\n\n [1] \"ACCNUM\"       \"ALIAS\"        \"ENSEMBL\"      \"ENSEMBLPROT\"  \"ENSEMBLTRANS\"\n [6] \"ENTREZID\"     \"ENZYME\"       \"EVIDENCE\"     \"EVIDENCEALL\"  \"GENENAME\"    \n[11] \"GENETYPE\"     \"GO\"           \"GOALL\"        \"IPI\"          \"MAP\"         \n[16] \"OMIM\"         \"ONTOLOGY\"     \"ONTOLOGYALL\"  \"PATH\"         \"PFAM\"        \n[21] \"PMID\"         \"PROSITE\"      \"REFSEQ\"       \"SYMBOL\"       \"UCSCKG\"      \n[26] \"UNIPROT\"     \n\n# convert from= \"ENSEMBL\" to \"SYMBOL\" and \"ENTREZID\"\ngene_convert &lt;- bitr(as.character(NK_vs_Th$ensembl_gene_id),\n  fromType = \"ENSEMBL\",\n  toType = c(\"SYMBOL\", \"ENTREZID\"), OrgDb = \"org.Hs.eg.db\"\n)\n\n'select()' returned 1:many mapping between keys and columns\n\n\nWarning in bitr(as.character(NK_vs_Th$ensembl_gene_id), fromType = \"ENSEMBL\", :\n18.73% of input gene IDs are fail to map...\n\n# Check the format of the data frame obtained after conversion:\nhead(gene_convert)\n\n          ENSEMBL SYMBOL ENTREZID\n1 ENSG00000000003 TSPAN6     7105\n2 ENSG00000000419   DPM1     8813\n3 ENSG00000000457  SCYL3    57147\n4 ENSG00000000460  FIRRM    55732\n5 ENSG00000000938    FGR     2268\n6 ENSG00000000971    CFH     3075\n\ndim(gene_convert)\n\n[1] 16794     3\n\n\n\n# Create a vector of genes that are coded with the EntrezID:\n# use the sorted gene list gl previously created:\ngl_kegg &lt;- cbind(SYMBOL = names(gl), t = gl)\n\n# merge with converted gene symbols to combine both:\n# by default the data frames are merged on the columns with names they both have\ngl_kegg &lt;- merge(gl_kegg, gene_convert)\nhead(gl_kegg)\n\n  SYMBOL            t         ENSEMBL ENTREZID\n1   A1BG  1.129187394 ENSG00000121410        1\n2    A2M -0.382294217 ENSG00000175899        2\n3 A4GALT  0.808365644 ENSG00000128274    53947\n4   AAAS  0.749990903 ENSG00000094914     8086\n5   AACS  2.172253591 ENSG00000081760    65985\n6  AADAT  3.038354213 ENSG00000109576    51166\n\ngl_kegg_list &lt;- as.numeric(as.character(gl_kegg$t))\nnames(gl_kegg_list) &lt;- as.character(gl_kegg$ENTREZID)\ngl_kegg_list &lt;- sort(gl_kegg_list, decreasing = T)\n\n# run GSEA of KEGG (please note that requires internet connection to download the KEGG annotations from http)\nKEGG_NK_Th &lt;- gseKEGG(gl_kegg_list,\n  organism = \"hsa\", \"ncbi-geneid\",\n  minGSSize = 30,\n  eps = 0,\n  seed = T\n)\n\nReading KEGG annotation online: \"https://rest.kegg.jp/link/hsa/pathway\"...\n\n\nReading KEGG annotation online: \"https://rest.kegg.jp/list/pathway/hsa\"...\n\n\nReading KEGG annotation online: \"https://rest.kegg.jp/conv/ncbi-geneid/hsa\"...\n\n\npreparing geneSet collections...\n\n\nGSEA analysis...\n\n\nWarning in preparePathwaysAndStats(pathways, stats, minSize, maxSize, gseaParam, : There are ties in the preranked stats (0.1% of the list).\nThe order of those tied genes will be arbitrary, which may produce unexpected results.\n\n\nWarning in preparePathwaysAndStats(pathways, stats, minSize, maxSize,\ngseaParam, : There are duplicate gene names, fgsea may produce unexpected\nresults.\n\n\nleading edge analysis...\n\n\ndone...\n\n\n\n# What does it contain?\nstr(KEGG_NK_Th)\n\nFormal class 'gseaResult' [package \"DOSE\"] with 13 slots\n  ..@ result     :'data.frame': 24 obs. of  11 variables:\n  .. ..$ ID             : chr [1:24] \"hsa03010\" \"hsa05171\" \"hsa04650\" \"hsa04666\" ...\n  .. ..$ Description    : chr [1:24] \"Ribosome\" \"Coronavirus disease - COVID-19\" \"Natural killer cell mediated cytotoxicity\" \"Fc gamma R-mediated phagocytosis\" ...\n  .. ..$ setSize        : int [1:24] 130 185 98 86 163 181 93 77 118 220 ...\n  .. ..$ enrichmentScore: num [1:24] -0.813 -0.678 0.62 0.525 0.426 ...\n  .. ..$ NES            : num [1:24] -3.46 -3.02 2.49 2.07 1.87 ...\n  .. ..$ pvalue         : num [1:24] 3.32e-46 5.30e-32 2.03e-12 1.23e-06 2.91e-06 ...\n  .. ..$ p.adjust       : num [1:24] 8.94e-44 7.13e-30 1.82e-10 8.24e-05 1.57e-04 ...\n  .. ..$ qvalue         : num [1:24] 7.31e-44 5.84e-30 1.49e-10 6.74e-05 1.28e-04 ...\n  .. ..$ rank           : num [1:24] 1852 1168 1873 1924 2216 ...\n  .. ..$ leading_edge   : chr [1:24] \"tags=72%, list=13%, signal=63%\" \"tags=48%, list=8%, signal=45%\" \"tags=52%, list=13%, signal=46%\" \"tags=42%, list=13%, signal=36%\" ...\n  .. ..$ core_enrichment: chr [1:24] \"63875/140032/51121/64983/6139/9553/51021/51116/6133/51065/65008/51187/64960/64981/6166/54460/6144/6234/51081/21\"| __truncated__ \"5600/6166/3454/3661/5595/6144/6234/7124/5335/7187/2197/9641/6203/6167/6168/7311/3558/6209/6146/6155/6201/6205/1\"| __truncated__ \"117157/5336/3804/3821/2207/3822/6850/6452/3802/5551/2214/7305/3805/3811/9437/7462/3809/3824/3823/51744/5594/300\"| __truncated__ \"5336/6850/2214/4067/3635/2934/5594/3984/81873/5880/10451/2212/7408/10092/1785/207/382/2215/2213/1793/8503/5580/\"| __truncated__ ...\n  ..@ organism   : chr \"hsa\"\n  ..@ setType    : chr \"KEGG\"\n  ..@ geneSets   :List of 366\n  .. ..$ hsa00010: chr [1:67] \"10327\" \"124\" \"125\" \"126\" ...\n  .. ..$ hsa00020: chr [1:30] \"1431\" \"1737\" \"1738\" \"1743\" ...\n  .. ..$ hsa00030: chr [1:31] \"132158\" \"2203\" \"221823\" \"226\" ...\n  .. ..$ hsa00040: chr [1:36] \"10327\" \"10720\" \"10941\" \"231\" ...\n  .. ..$ hsa00051: chr [1:34] \"197258\" \"2203\" \"226\" \"229\" ...\n  .. ..$ hsa00052: chr [1:32] \"130589\" \"231\" \"2538\" \"2548\" ...\n  .. ..$ hsa00053: chr [1:30] \"10327\" \"10720\" \"10941\" \"217\" ...\n  .. ..$ hsa00061: chr [1:18] \"109703458\" \"197322\" \"2180\" \"2181\" ...\n  .. ..$ hsa00062: chr [1:28] \"10449\" \"10965\" \"11332\" \"117145\" ...\n  .. ..$ hsa00071: chr [1:43] \"10449\" \"10455\" \"113612\" \"124\" ...\n  .. ..$ hsa00100: chr [1:20] \"1056\" \"10682\" \"120227\" \"1591\" ...\n  .. ..$ hsa00120: chr [1:17] \"10005\" \"10858\" \"10998\" \"1109\" ...\n  .. ..$ hsa00130: chr [1:12] \"10229\" \"154807\" \"1728\" \"2677\" ...\n  .. ..$ hsa00140: chr [1:63] \"100861540\" \"10720\" \"10941\" \"1109\" ...\n  .. ..$ hsa00190: chr [1:138] \"100532726\" \"10063\" \"101927180\" \"10312\" ...\n  .. ..$ hsa00220: chr [1:23] \"100526760\" \"1373\" \"137362\" \"162417\" ...\n  .. ..$ hsa00230: chr [1:128] \"100\" \"100526794\" \"10201\" \"102157402\" ...\n  .. ..$ hsa00232: chr [1:6] \"10\" \"1544\" \"1548\" \"1549\" ...\n  .. ..$ hsa00240: chr [1:58] \"100526794\" \"10201\" \"115024\" \"124583\" ...\n  .. ..$ hsa00250: chr [1:37] \"122622\" \"1373\" \"137362\" \"158\" ...\n  .. ..$ hsa00260: chr [1:41] \"102724560\" \"10993\" \"113675\" \"124908081\" ...\n  .. ..$ hsa00270: chr [1:52] \"102724560\" \"1036\" \"10768\" \"10993\" ...\n  .. ..$ hsa00280: chr [1:48] \"10449\" \"11112\" \"1629\" \"1738\" ...\n  .. ..$ hsa00290: chr [1:4] \"10993\" \"113675\" \"586\" \"587\"\n  .. ..$ hsa00310: chr [1:63] \"10157\" \"10919\" \"11105\" \"123688\" ...\n  .. ..$ hsa00330: chr [1:50] \"112483\" \"112817\" \"112849\" \"113451\" ...\n  .. ..$ hsa00340: chr [1:22] \"10841\" \"131669\" \"138199\" \"144193\" ...\n  .. ..$ hsa00350: chr [1:36] \"124\" \"125\" \"126\" \"127\" ...\n  .. ..$ hsa00360: chr [1:16] \"137362\" \"1644\" \"218\" \"221\" ...\n  .. ..$ hsa00380: chr [1:42] \"11185\" \"121278\" \"125061\" \"130013\" ...\n  .. ..$ hsa00400: chr [1:6] \"137362\" \"259307\" \"2805\" \"2806\" ...\n  .. ..$ hsa00410: chr [1:31] \"18\" \"1806\" \"1807\" \"1892\" ...\n  .. ..$ hsa00430: chr [1:17] \"102724197\" \"1036\" \"124975\" \"2326\" ...\n  .. ..$ hsa00440: chr [1:6] \"10390\" \"5130\" \"56994\" \"5833\" ...\n  .. ..$ hsa00450: chr [1:17] \"10587\" \"11185\" \"114112\" \"118672\" ...\n  .. ..$ hsa00470: chr [1:6] \"1610\" \"27165\" \"2744\" \"63826\" ...\n  .. ..$ hsa00480: chr [1:59] \"102724197\" \"10314\" \"119391\" \"124975\" ...\n  .. ..$ hsa00500: chr [1:40] \"11181\" \"124905666\" \"124905668\" \"128966568\" ...\n  .. ..$ hsa00510: chr [1:55] \"10195\" \"10905\" \"11253\" \"11282\" ...\n  .. ..$ hsa00511: chr [1:18] \"10825\" \"129807\" \"175\" \"23324\" ...\n  .. ..$ hsa00512: chr [1:36] \"100528030\" \"10331\" \"10610\" \"11226\" ...\n  .. ..$ hsa00513: chr [1:43] \"10195\" \"10905\" \"11253\" \"11282\" ...\n  .. ..$ hsa00514: chr [1:47] \"100528030\" \"10585\" \"11226\" \"11227\" ...\n  .. ..$ hsa00515: chr [1:23] \"10329\" \"10585\" \"10690\" \"11041\" ...\n  .. ..$ hsa00520: chr [1:38] \"10007\" \"10020\" \"1118\" \"132789\" ...\n  .. ..$ hsa00524: chr [1:5] \"2645\" \"3098\" \"3099\" \"3101\" ...\n  .. ..$ hsa00531: chr [1:19] \"10855\" \"138050\" \"23553\" \"2588\" ...\n  .. ..$ hsa00532: chr [1:21] \"10090\" \"11285\" \"113189\" \"126792\" ...\n  .. ..$ hsa00533: chr [1:14] \"10164\" \"10678\" \"2530\" \"2683\" ...\n  .. ..$ hsa00534: chr [1:24] \"11285\" \"126792\" \"2131\" \"2132\" ...\n  .. ..$ hsa00541: chr [1:20] \"10020\" \"123956252\" \"140838\" \"1727\" ...\n  .. ..$ hsa00561: chr [1:65] \"10327\" \"10554\" \"10555\" \"1056\" ...\n  .. ..$ hsa00562: chr [1:73] \"10423\" \"113026\" \"138429\" \"200576\" ...\n  .. ..$ hsa00563: chr [1:30] \"10026\" \"128869\" \"23556\" \"27315\" ...\n  .. ..$ hsa00564: chr [1:103] \"100137049\" \"10162\" \"10390\" \"1040\" ...\n  .. ..$ hsa00565: chr [1:50] \"100137049\" \"10390\" \"11145\" \"122618\" ...\n  .. ..$ hsa00590: chr [1:63] \"100137049\" \"102724197\" \"10728\" \"11145\" ...\n  .. ..$ hsa00591: chr [1:30] \"100137049\" \"11145\" \"123745\" \"151056\" ...\n  .. ..$ hsa00592: chr [1:26] \"100137049\" \"11145\" \"123745\" \"151056\" ...\n  .. ..$ hsa00600: chr [1:54] \"10558\" \"10715\" \"10825\" \"123099\" ...\n  .. ..$ hsa00601: chr [1:28] \"10317\" \"10331\" \"10402\" \"10678\" ...\n  .. ..$ hsa00603: chr [1:16] \"10317\" \"10690\" \"127550\" \"2523\" ...\n  .. ..$ hsa00604: chr [1:15] \"256435\" \"2583\" \"27090\" \"2720\" ...\n  .. ..$ hsa00620: chr [1:47] \"10327\" \"10873\" \"124\" \"125\" ...\n  .. ..$ hsa00630: chr [1:32] \"112817\" \"124908081\" \"125061\" \"132158\" ...\n  .. ..$ hsa00640: chr [1:32] \"160287\" \"1629\" \"1738\" \"18\" ...\n  .. ..$ hsa00650: chr [1:27] \"116285\" \"123876\" \"142827\" \"18\" ...\n  .. ..$ hsa00670: chr [1:39] \"100528021\" \"102724560\" \"10588\" \"10768\" ...\n  .. ..$ hsa00730: chr [1:15] \"122481\" \"158067\" \"203\" \"204\" ...\n  .. ..$ hsa00740: chr [1:8] \"5167\" \"5169\" \"52\" \"53\" ...\n  .. ..$ hsa00750: chr [1:6] \"29968\" \"316\" \"493911\" \"55163\" ...\n  .. ..$ hsa00760: chr [1:38] \"100526794\" \"10135\" \"133686\" \"22933\" ...\n  .. ..$ hsa00770: chr [1:21] \"1806\" \"1807\" \"217\" \"219\" ...\n  .. ..$ hsa00780: chr [1:3] \"3141\" \"54995\" \"686\"\n  .. ..$ hsa00785: chr [1:20] \"11019\" \"116285\" \"124908081\" \"1629\" ...\n  .. ..$ hsa00790: chr [1:28] \"10243\" \"121278\" \"1719\" \"200895\" ...\n  .. ..$ hsa00830: chr [1:68] \"100861540\" \"10170\" \"10720\" \"10901\" ...\n  .. ..$ hsa00860: chr [1:46] \"10720\" \"10941\" \"124454\" \"1352\" ...\n  .. ..$ hsa00900: chr [1:23] \"100529261\" \"10269\" \"10654\" \"116150\" ...\n  .. ..$ hsa00910: chr [1:17] \"11238\" \"1373\" \"23632\" \"2746\" ...\n  .. ..$ hsa00920: chr [1:10] \"10380\" \"23474\" \"4357\" \"54928\" ...\n  .. ..$ hsa00970: chr [1:66] \"10056\" \"10352\" \"10667\" \"118672\" ...\n  .. ..$ hsa00980: chr [1:79] \"10720\" \"107987478\" \"107987479\" \"10941\" ...\n  .. ..$ hsa00982: chr [1:73] \"10720\" \"107987478\" \"107987479\" \"10941\" ...\n  .. ..$ hsa00983: chr [1:81] \"10\" \"10201\" \"1066\" \"10720\" ...\n  .. ..$ hsa01040: chr [1:27] \"10965\" \"11332\" \"122970\" \"201562\" ...\n  .. ..$ hsa01100: chr [1:1570] \"10\" \"100\" \"10005\" \"10007\" ...\n  .. ..$ hsa01200: chr [1:116] \"10873\" \"10993\" \"113675\" \"124908081\" ...\n  .. ..$ hsa01210: chr [1:33] \"100526760\" \"137362\" \"1431\" \"162417\" ...\n  .. ..$ hsa01212: chr [1:57] \"10449\" \"109703458\" \"126129\" \"1374\" ...\n  .. ..$ hsa01230: chr [1:75] \"100526760\" \"102724560\" \"10993\" \"113675\" ...\n  .. ..$ hsa01232: chr [1:85] \"100\" \"100526794\" \"10201\" \"102157402\" ...\n  .. ..$ hsa01240: chr [1:154] \"10201\" \"102157402\" \"10229\" \"10243\" ...\n  .. ..$ hsa01250: chr [1:37] \"10020\" \"140838\" \"197258\" \"23483\" ...\n  .. ..$ hsa01320: chr [1:2] \"9060\" \"9061\"\n  .. ..$ hsa01521: chr [1:80] \"10000\" \"10018\" \"110117499\" \"1950\" ...\n  .. ..$ hsa01522: chr [1:99] \"10000\" \"1019\" \"1026\" \"1027\" ...\n  .. ..$ hsa01523: chr [1:30] \"10057\" \"10257\" \"113235\" \"1147\" ...\n  .. ..$ hsa01524: chr [1:75] \"10000\" \"1026\" \"1029\" \"110117499\" ...\n  .. .. [list output truncated]\n  ..@ geneList   : Named num [1:14284] 19 13.1 12.1 12 10.7 ...\n  .. ..- attr(*, \"names\")= chr [1:14284] \"2693\" \"23209\" \"117157\" \"6983\" ...\n  ..@ keytype    : chr \"ncbi-geneid\"\n  ..@ permScores : num[0 , 0 ] \n  ..@ params     :List of 6\n  .. ..$ pvalueCutoff : num 0.05\n  .. ..$ eps          : num 0\n  .. ..$ pAdjustMethod: chr \"BH\"\n  .. ..$ exponent     : num 1\n  .. ..$ minGSSize    : num 30\n  .. ..$ maxGSSize    : num 500\n  ..@ gene2Symbol: chr(0) \n  ..@ readable   : logi FALSE\n  ..@ termsim    : num[0 , 0 ] \n  ..@ method     : chr(0) \n  ..@ dr         : list()\n\n\n\n# How many gene sets are up-regulated?\nsum(KEGG_NK_Th@result$NES &gt; 0) # 17\n\n[1] 17\n\n\n\n#|\ngrep_kegg_description &lt;- function(pattern) {\n  return(grep(pattern, tolower((KEGG_NK_Th@result$Description))))\n}\n\n\n# Is their an immune-related gene set significant?\ngrep_kegg_description(\"immune\")\n\ninteger(0)\n\n\n\n# Is their an NK gene set significant?\ngrep_kegg_description(\"natural killer\") # 3\n\n[1] 3\n\n\n\n# What is the total number of built-in KEGG gene sets?\nlength(KEGG_NK_Th@geneSets) # 265\n\n[1] 366\n\n\n\nKEGG_NK_Th[grep_kegg_description(\"natural killer\"), ] |&gt;\n  select(ID, Description) # hsa04650\n\n               ID                               Description\nhsa04650 hsa04650 Natural killer cell mediated cytotoxicity\n\n\n\nKEGG_NK_Th@geneSets$hsa04650\n\n  [1] \"100132285\" \"100507436\" \"100528032\" \"102723407\" \"10451\"     \"10870\"    \n  [7] \"110117499\" \"117157\"    \"124905743\" \"135250\"    \"1437\"      \"154064\"   \n [13] \"2185\"      \"2207\"      \"2214\"      \"2215\"      \"22914\"     \"2534\"     \n [19] \"25759\"     \"259197\"    \"27040\"     \"2885\"      \"3002\"      \"3105\"     \n [25] \"3106\"      \"3107\"      \"3133\"      \"3135\"      \"3265\"      \"3383\"     \n [31] \"3384\"      \"3439\"      \"3440\"      \"3441\"      \"3442\"      \"3443\"     \n [37] \"3444\"      \"3445\"      \"3446\"      \"3447\"      \"3448\"      \"3449\"     \n [43] \"3451\"      \"3452\"      \"3454\"      \"3455\"      \"3456\"      \"3458\"     \n [49] \"3459\"      \"3460\"      \"353091\"    \"355\"       \"356\"       \"3683\"     \n [55] \"3689\"      \"369\"       \"3802\"      \"3803\"      \"3804\"      \"3805\"     \n [61] \"3806\"      \"3808\"      \"3809\"      \"3810\"      \"3811\"      \"3812\"     \n [67] \"3821\"      \"3822\"      \"3823\"      \"3824\"      \"3845\"      \"3932\"     \n [73] \"3937\"      \"399694\"    \"4068\"      \"4277\"      \"4772\"      \"4773\"     \n [79] \"4893\"      \"5058\"      \"51744\"     \"5290\"      \"5291\"      \"5293\"     \n [85] \"5295\"      \"5296\"      \"5335\"      \"53358\"     \"5336\"      \"5530\"     \n [91] \"5532\"      \"5533\"      \"5534\"      \"5535\"      \"5551\"      \"5578\"     \n [97] \"5579\"      \"5582\"      \"5594\"      \"5595\"      \"5604\"      \"5605\"     \n[103] \"57292\"     \"5777\"      \"5781\"      \"5879\"      \"5880\"      \"5881\"     \n[109] \"5894\"      \"637\"       \"6452\"      \"6464\"      \"6654\"      \"6655\"     \n[115] \"673\"       \"6850\"      \"7124\"      \"7305\"      \"7409\"      \"7410\"     \n[121] \"7462\"      \"7535\"      \"79465\"     \"80328\"     \"80329\"     \"836\"      \n[127] \"8503\"      \"8743\"      \"8795\"      \"8797\"      \"919\"       \"9436\"     \n[133] \"9437\"      \"962\"      \n\n\n\n# pathview map with non-significant genes in grey:\n# set log fold change of non-significant genes to 0:\nNK_vs_Th$logFC_0 &lt;- ifelse(NK_vs_Th$p.adj &gt; 0.05, 0, NK_vs_Th$logFC)\n\n# create named vector of fold change values:\ngenePW &lt;- NK_vs_Th$logFC_0\nnames(genePW) &lt;- NK_vs_Th$symbol\n\n# Create pathview map for Ribosome = hsa03010\npathview(\n  gene.data = genePW,\n  pathway.id = \"hsa03010\",\n  species = \"hsa\",\n  gene.idtype = \"SYMBOL\"\n)\n\n'select()' returned 1:many mapping between keys and columns\n\n\n[1] \"Note: 4806 of 20411 unique input IDs unmapped.\"\n\n\n'select()' returned 1:1 mapping between keys and columns\n\n\nInfo: Working in directory /var/home/artur/Documents/10-19_PhD/11_Education/11.22-sib-enrichment-analysis\n\n\nInfo: Writing image file hsa03010.pathview.png\n\n# Create pathview map of Natural killer cell mediated cytotoxicity = hsa04650\npathview(\n  gene.data = genePW,\n  pathway.id = \"hsa04650\",\n  species = \"hsa\",\n  gene.idtype = \"SYMBOL\"\n)\n\n'select()' returned 1:many mapping between keys and columns\n\n\n[1] \"Note: 4806 of 20411 unique input IDs unmapped.\"\n\n\n'select()' returned 1:1 mapping between keys and columns\n\n\nInfo: Working in directory /var/home/artur/Documents/10-19_PhD/11_Education/11.22-sib-enrichment-analysis\n\n\nInfo: Writing image file hsa04650.pathview.png\n\n\n\n# Import hallmark, convert to term2gene and run GSEA:\nterm2gene_h &lt;- msigdbr(species = \"Homo sapiens\", category = \"H\")\n# Or alternatively:\n# term2gene_h&lt;-read.gmt(\"h.all.v2023.2.Hs.symbols.gmt\")\n\nhead(term2gene_h)\n\n# A tibble: 6 × 15\n  gs_cat gs_subcat gs_name               gene_symbol entrez_gene ensembl_gene   \n  &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;                 &lt;chr&gt;             &lt;int&gt; &lt;chr&gt;          \n1 H      \"\"        HALLMARK_ADIPOGENESIS ABCA1                19 ENSG00000165029\n2 H      \"\"        HALLMARK_ADIPOGENESIS ABCB8             11194 ENSG00000197150\n3 H      \"\"        HALLMARK_ADIPOGENESIS ACAA2             10449 ENSG00000167315\n4 H      \"\"        HALLMARK_ADIPOGENESIS ACADL                33 ENSG00000115361\n5 H      \"\"        HALLMARK_ADIPOGENESIS ACADM                34 ENSG00000117054\n6 H      \"\"        HALLMARK_ADIPOGENESIS ACADS                35 ENSG00000122971\n# ℹ 9 more variables: human_gene_symbol &lt;chr&gt;, human_entrez_gene &lt;int&gt;,\n#   human_ensembl_gene &lt;chr&gt;, gs_id &lt;chr&gt;, gs_pmid &lt;chr&gt;, gs_geoid &lt;chr&gt;,\n#   gs_exact_source &lt;chr&gt;, gs_url &lt;chr&gt;, gs_description &lt;chr&gt;\n\nlength(unique(term2gene_h$gs_name)) # 50\n\n[1] 50\n\n# Run GSEA with the function that allows to use custom gene sets,\n# provide the named vector of t statistics\nh_NK_vs_Th &lt;- GSEA(gl,\n  TERM2GENE = term2gene_h[, c(\"gs_name\", \"gene_symbol\")],\n  eps = 0,\n  seed = T\n)\n\npreparing geneSet collections...\n\n\nGSEA analysis...\n\n\nWarning in preparePathwaysAndStats(pathways, stats, minSize, maxSize, gseaParam, : There are ties in the preranked stats (0.07% of the list).\nThe order of those tied genes will be arbitrary, which may produce unexpected results.\n\n\nleading edge analysis...\n\n\ndone...\n\n# Number of significant gene sets:\nlength(which(h_NK_vs_Th@result$p.adjust &lt;= 0.05))\n\n[1] 4\n\n\n\n# A dotplot with geneRatio or NES on the x-axis:\ndotplot(h_NK_vs_Th)\n\n\n\n\n\n\n\ndotplot(h_NK_vs_Th, x = \"NES\", orderBy = \"p.adjust\")\n\n\n\n\n\n\n\n# A barcode plot:\ngseaplot2(h_NK_vs_Th,\n  geneSetID = \"HALLMARK_MTORC1_SIGNALING\",\n  title = \"HALLMARK_MTORC1_SIGNALING\"\n)"
  },
  {
    "objectID": "sib_enrichment_analysis_exercises.html#extra-exercises",
    "href": "sib_enrichment_analysis_exercises.html#extra-exercises",
    "title": "SIB - Enrichment Analysis",
    "section": "Extra exercises",
    "text": "Extra exercises\n\n# Read in Reactome genes\nreactome_gene_sets &lt;- msigdbr(category = \"C2\", subcategory = \"CP:REACTOME\")\n\n# Run GSEA with Reactome database\nreactome_NK_vs_Th &lt;- GSEA(gl,\n  minGSSize = 30,\n  TERM2GENE = reactome_gene_sets[, c(\"gs_name\", \"gene_symbol\")],\n  eps = 0, seed = TRUE\n)\n\npreparing geneSet collections...\n\n\nGSEA analysis...\n\n\nWarning in preparePathwaysAndStats(pathways, stats, minSize, maxSize, gseaParam, : There are ties in the preranked stats (0.07% of the list).\nThe order of those tied genes will be arbitrary, which may produce unexpected results.\n\n\nleading edge analysis...\n\n\ndone...\n\n# Count number of significant gene sets\nreactome_significant &lt;- length(which(reactome_NK_vs_Th@result$p.adjust &lt; 0.05))\nprint(paste(\"Number of significant gene sets with Reactome database is\", reactome_significant))\n\n[1] \"Number of significant gene sets with Reactome database is 53\"\n\n\n\npar(mar = c(5, 20, 3, 3) + 0.1)\n# Recode long labels\nreactome_NK_vs_Th@result$Description_short &lt;-\n  reactome_NK_vs_Th@result$Description |&gt;\n  case_match(\n    \"REACTOME_REGULATION_OF_EXPRESSION_OF_SLITS_AND_ROBOS\" ~ \"Slits/robos expression regulation\",\n    \"REACTOME_RRNA_PROCESSING\" ~ \"rRNA processing\",\n    \"REACTOME_INFLUENZA_INFECTION\" ~ \"Influenza infection\",\n    \"REACTOME_SELENOAMINO_ACID_METABOLISM\" ~ \"Selenoaminoacid metabolism\",\n    \"REACTOME_SRP_DEPENDENT_COTRANSLATIONAL_PROTEIN_TARGETING_TO_MEMBRANE\" ~ \"SRP-dep. cotranslational membrane targeting\",\n    \"REACTOME_RESPONSE_OF_EIF2AK4_GCN2_TO_AMINO_ACID_DEFICIENCY\" ~ \"EIF2AK4(GCN2) AA deficiency response\",\n    \"REACTOME_NONSENSE_MEDIATED_DECAY_NMD\" ~ \"Nonsense mediated decay NMD\",\n    \"REACTOME_EUKARYOTIC_TRANSLATION_INITIATION\" ~ \"Eukaryotic translation initiation\",\n    \"REACTOME_TRANSLATION\" ~ \"Translation\",\n    \"REACTOME_EUKARYOTIC_TRANSLATION_ELONGATION\" ~ \"Eukaryotic translation elongation\"\n  )\n\n# Bar plot\nbarplot(rev(-log10(reactome_NK_vs_Th@result$p.adjust[1:10])),\n  horiz = TRUE, names = rev(reactome_NK_vs_Th@result$Description_short[1:10]),\n  las = 2, xlab = \"-log10(adj.p-value)\",\n  cex.names = 0.7,\n  col = \"lightgreen\"\n)\nabline(v = -log10(0.05))\n\n\n\n\n\n\n\n\n\nreactome_NK_vs_Th@result$Description_short2&lt;-gsub(\"_\", \" \", \n                                                  gsub(\"REACTOME_\", \"\",\n                                                       reactome_NK_vs_Th@result$Description))\nreactome_NK_vs_Th_sorted&lt;-reactome_NK_vs_Th@result[order(reactome_NK_vs_Th@result$NES,\n                                                         decreasing = F),]\n\nreactome_NK_vs_Th_sorted$colors &lt;- ifelse(reactome_NK_vs_Th_sorted$NES &gt; 0, \"red\", \"blue\")\n\n\npar(mar = c(4, 30, 1, 1)) # Make the figure margins larger\nbarplot(reactome_NK_vs_Th_sorted$NES,\n        horiz = TRUE, names = reactome_NK_vs_Th_sorted$Description_short2,\n        las = 2, xlab = \"Normalized enrichment score\",\n        cex.names = 0.5,\n        col = reactome_NK_vs_Th_sorted$colors\n)\n\n\n\n\n\n\n\n\n\ngseaplot(reactome_NK_vs_Th,\n  geneSetID = \"REACTOME_EUKARYOTIC_TRANSLATION_ELONGATION\",\n  title = \"Reactome - Eukaryotic translation elongation\"\n)\n\n\n\n\n\n\n\n\n\ngseaplot(reactome_NK_vs_Th,\n  geneSetID = \"REACTOME_DAP12_INTERACTIONS\",\n  title = \"Reactome - DAP12 interaction\"\n)"
  }
]